services:
  memoir-app:
    build:
      context: .
      dockerfile: Dockerfile
    image: memoir-app:latest
    container_name: memoir-app
    ports:
      - "3000:3000"
    environment:
      NODE_ENV: production
      # 运行时注入的环境变量 (Run-time Injection)
      # 使用 RUNTIME_ 前缀是为了避开 Next.js 的构建时自动内联 (Inlining)
      RUNTIME_API_BASE_URL: ${NEXT_PUBLIC_API_BASE_URL:-https://you-domain.com}
      RUNTIME_API_PREFIX: ${NEXT_PUBLIC_API_PREFIX:-/api/v1}
      RUNTIME_APP_URL: ${NEXT_PUBLIC_APP_URL:-http://you-domain.com}
      RUNTIME_AMAP_API_KEY: ${NEXT_PUBLIC_AMAP_API_KEY}
    restart: unless-stopped
 
